<%@ page contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>Trip Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
</head>
<body class="bg-light">
<%@ include file="nav.jsp" %>
<div class="container mt-4">
  <h2 class="mb-3">Trip Details</h2>
  <form action="${pageContext.request.contextPath}/trip-details/save" method="post" class="card p-4 mb-4 shadow-sm bg-white">
    <div class="row g-3">
      <div class="col-md-2">
        <label class="form-label">Trip Number</label>
        <input type="number" name="tripNumber" class="form-control" required/>
      </div>
      <div class="col-md-2">
        <label class="form-label">Driver</label>
        <select name="driver.id" class="form-select" required>
          <option value="">-- Select Driver --</option>
          <c:forEach var="d" items="${drivers}">
            <option value="${d.id}">${d.name}</option>
          </c:forEach>
        </select>
      </div>
      <div class="col-md-2">
        <label class="form-label">Co-Driver</label>
        <select name="codriver.id" class="form-select">
          <option value="">-- Select Co-Driver --</option>
          <c:forEach var="d" items="${drivers}">
            <option value="${d.id}">${d.name}</option>
          </c:forEach>
        </select>
      </div>
      <div class="col-md-2">
        <label class="form-label">Van</label>
        <select name="van.id" class="form-select" required>
          <option value="">-- Select Van --</option>
          <c:forEach var="v" items="${vans}">
            <option value="${v.id}">${v.vehicleNumber}</option>
          </c:forEach>
        </select>
      </div>
      <div class="col-md-2">
        <label class="form-label">Start Date</label>
        <input type="date" name="startDate" class="form-control" required/>
      </div>
      <div class="col-md-2">
        <label class="form-label">End Date</label>
        <input type="date" name="endDate" class="form-control" required/>
      </div>
      <div class="col-md-2">
        <label class="form-label">Loading Point</label>
        <input type="text" name="loadingPoint" class="form-control"/>
      </div>
      <div class="col-md-2">
        <label class="form-label">Fuel Cost</label>
        <input type="number" name="fuelCost" class="form-control" step="0.01"/>
      </div>
      <div class="col-md-2">
        <label class="form-label">Fuel Bill No.</label>
        <input type="text" name="fuelBillNumber" class="form-control"/>
      </div>
      <div class="col-md-2">
        <label class="form-label">Dead Chicks</label>
        <input type="number" name="deadChicks" class="form-control"/>
      </div>
      <div class="col-md-2">
        <label class="form-label">Dead Chicks Weight</label>
        <input type="number" name="deadChicksWeight" class="form-control" step="0.01"/>
      </div>
      <div class="col-md-2">
        <label class="form-label">Expenses</label>
        <input type="number" name="expenses" class="form-control" step="0.01"/>
      </div>
      <div class="col-md-12 text-end mt-3">
        <button type="submit" class="btn btn-primary px-4">Save</button>
        <button type="reset" class="btn btn-secondary ms-2 px-4">Clear</button>
      </div>
    </div>
  </form>
  <table class="table table-bordered table-hover bg-white shadow-sm">
    <thead class="table-dark">
      <tr>
        <th>Trip Number</th><th>Driver</th><th>Co-Driver</th><th>Van</th><th>Start Date</th><th>End Date</th><th>Loading Point</th><th>Fuel Cost</th><th>Fuel Bill No.</th><th>Dead Chicks</th><th>Dead Chicks Weight</th><th>Expenses</th><th>Action</th>
      </tr>
    </thead>
    <tbody>
      <c:forEach var="t" items="${tripDetailsList}">
        <tr>
          <td>${t.tripNumber}</td>
          <td><c:out value="${t.driver != null ? t.driver.name : ''}"/></td>
          <td><c:out value="${t.codriver != null ? t.codriver.name : ''}"/></td>
          <td><c:out value="${t.van != null ? t.van.vehicleNumber : ''}"/></td>
          <td>${t.startDate}</td>
          <td>${t.endDate}</td>
          <td>${t.loadingPoint}</td>
          <td>${t.fuelCost}</td>
          <td>${t.fuelBillNumber}</td>
          <td>${t.deadChicks}</td>
          <td>${t.deadChicksWeight}</td>
          <td>${t.expenses}</td>
          <td class="d-flex gap-1">
            <a href="${pageContext.request.contextPath}/trip-details/delete/${t.id}" class="btn btn-sm btn-outline-danger p-1" onclick="return confirm('Delete this trip detail?');" title="Delete">
              <i class="bi bi-trash"></i>
            </a>
          </td>
        </tr>
      </c:forEach>
    </tbody>
  </table>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>